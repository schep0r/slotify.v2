{% extends 'base.html.twig' %}

{% block title %}Transaction Details - {{ parent() }}{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    <style>
        .detail-card {
            @apply bg-gray-800 rounded-lg shadow-xl p-8;
        }
        .detail-row {
            @apply flex justify-between py-3 border-b border-gray-700;
        }
        .detail-row:last-child {
            @apply border-b-0;
        }
        .back-btn {
            @apply bg-gray-600 hover:bg-gray-700 text-white font-semibold py-2 px-4 rounded-lg transition-colors duration-200;
        }
    </style>
{% endblock %}

{% block body %}
<div class="container mx-auto px-4 py-8">
    <div class="max-w-2xl mx-auto">
        <!-- Back Button -->
        <div class="mb-6">
            <a href="{{ path('app_transactions') }}" class="back-btn">
                ‚Üê Back to Transaction History
            </a>
        </div>

        <div class="detail-card">
            <!-- Transaction Header -->
            <div class="text-center mb-8">
                <div class="text-6xl mb-4">
                    {% if transaction.type == 'deposit' %}üí∞
                    {% elseif transaction.type == 'bonus' %}üéÅ
                    {% elseif transaction.type == 'bet' %}üé∞
                    {% elseif transaction.type == 'win' %}üèÜ
                    {% elseif transaction.type == 'withdrawal' %}üí∏
                    {% elseif transaction.type == 'refund' %}üîÑ
                    {% else %}üìù
                    {% endif %}
                </div>
                <h1 class="text-3xl font-bold text-white mb-2">
                    {{ transaction.type|title }} Transaction
                </h1>
                <p class="text-xl
                    {% if transaction.type in ['deposit', 'bonus', 'win', 'refund'] %}text-green-400
                    {% else %}text-red-400
                    {% endif %}">
                    {% if transaction.type in ['deposit', 'bonus', 'win', 'refund'] %}+{% else %}-{% endif %}${{ transaction.amount|number_format(2) }}
                </p>
            </div>

            <!-- Transaction Details -->
            <div class="space-y-0">
                <div class="detail-row">
                    <span class="text-gray-300">Transaction ID:</span>
                    <span class="text-white font-mono">{{ transaction.referenceId }}</span>
                </div>
                
                <div class="detail-row">
                    <span class="text-gray-300">Date & Time:</span>
                    <span class="text-white">{{ transaction.createdAt|date('F j, Y g:i:s A') }}</span>
                </div>
                
                <div class="detail-row">
                    <span class="text-gray-300">Type:</span>
                    <span class="text-white">{{ transaction.type|title }}</span>
                </div>
                
                <div class="detail-row">
                    <span class="text-gray-300">Amount:</span>
                    <span class="text-white font-semibold">${{ transaction.amount|number_format(2) }}</span>
                </div>
                
                <div class="detail-row">
                    <span class="text-gray-300">Status:</span>
                    <span class="px-3 py-1 rounded text-sm
                        {% if transaction.status == 'completed' %}bg-green-800 text-green-200
                        {% elseif transaction.status == 'pending' %}bg-yellow-800 text-yellow-200
                        {% elseif transaction.status == 'failed' %}bg-red-800 text-red-200
                        {% else %}bg-gray-700 text-gray-300
                        {% endif %}">
                        {{ transaction.status|title }}
                    </span>
                </div>
                
                {% if transaction.description %}
                    <div class="detail-row">
                        <span class="text-gray-300">Description:</span>
                        <span class="text-white">{{ transaction.description }}</span>
                    </div>
                {% endif %}
                
                {% if transaction.paymentMethod %}
                    <div class="detail-row">
                        <span class="text-gray-300">Payment Method:</span>
                        <span class="text-white">{{ transaction.paymentMethod|title }}</span>
                    </div>
                {% endif %}
                
                <div class="detail-row">
                    <span class="text-gray-300">Balance Before:</span>
                    <span class="text-white">${{ transaction.balanceBefore|number_format(2) }}</span>
                </div>
                
                <div class="detail-row">
                    <span class="text-gray-300">Balance After:</span>
                    <span class="text-cyan-400 font-semibold">${{ transaction.balanceAfter|number_format(2) }}</span>
                </div>
                
                {% if transaction.gameSession %}
                    <div class="detail-row">
                        <span class="text-gray-300">Game Session:</span>
                        <span class="text-white">{{ transaction.gameSession.id }}</span>
                    </div>
                {% endif %}
            </div>

            <!-- Metadata -->
            {% if transaction.metadata %}
                <div class="mt-8">
                    <h3 class="text-lg font-semibold text-white mb-4">Additional Information</h3>
                    <div class="bg-gray-700 rounded-lg p-4">
                        {% for key, value in transaction.metadata %}
                            <div class="flex justify-between py-2 text-sm">
                                <span class="text-gray-300">{{ key|replace({'_': ' '})|title }}:</span>
                                <span class="text-white">
                                    {% if value is iterable and value is not string %}
                                        {{ value|join(', ') }}
                                    {% else %}
                                        {{ value }}
                                    {% endif %}
                                </span>
                            </div>
                        {% endfor %}
                    </div>
                </div>
            {% endif %}

            <!-- Spin Result (for game transactions) -->
            {% if transaction.spinResult %}
                <div class="mt-8">
                    <h3 class="text-lg font-semibold text-white mb-4">Spin Result</h3>
                    <div class="bg-gray-700 rounded-lg p-4">
                        <pre class="text-sm text-gray-300 overflow-x-auto">{{ transaction.spinResult|json_encode(constant('JSON_PRETTY_PRINT')) }}</pre>
                    </div>
                </div>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}